/**
 * @packageDocumentation
 *
 * emoji ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
 *
 * ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã«ã€Œçµµæ–‡å­—ã€ã€Œé¡”æ–‡å­—ã€ã€Œemojiã€ã€Œç¦ç¬‘ã„ã€ãŒå«ã¾ã‚ŒãŸã‚‰ã€
 * ãƒ©ãƒ³ãƒ€ãƒ ãªæ‰‹ã¨é¡”ã®çµµæ–‡å­—ã‚’çµ„ã¿åˆã‚ã›ãŸé¡”æ–‡å­—ã‚’ç”Ÿæˆã—ã¦è¿”ä¿¡ã™ã‚‹ã€‚
 *
 * @remarks
 * - ã€Œæƒ…å ±ã€ã‚’å«ã‚€å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—ï¼ˆã€Œçµµæ–‡å­—æƒ…å ±ã€ç­‰ã¸ã®èª¤åå¿œã‚’é˜²æ­¢ï¼‰
 * - æ‰‹ã®çµµæ–‡å­—ã«ã¯å·¦å³ãƒšã‚¢ã®ã‚‚ã®ï¼ˆé…åˆ—ï¼‰ã¨å˜ä½“ã®ã‚‚ã®ï¼ˆæ–‡å­—åˆ—ï¼‰ãŒã‚ã‚‹
 * - ãƒšã‚¢ã®å ´åˆã¯ `å·¦æ‰‹ + é¡” + å³æ‰‹`ã€å˜ä½“ã®å ´åˆã¯ `æ‰‹ + é¡” + æ‰‹` ã®æ§‹æˆ
 *
 * @internal
 */
import autobind from 'autobind-decorator';
import Module from '@/module';
import Message from '@/message';
import serifs from '@/serifs';

/**
 * æ‰‹ã®çµµæ–‡å­—ãƒªã‚¹ãƒˆ
 *
 * @remarks
 * æ–‡å­—åˆ—ã®å ´åˆã¯å·¦å³åŒã˜çµµæ–‡å­—ã€‚
 * é…åˆ—ã®å ´åˆã¯ `[å·¦æ‰‹, å³æ‰‹]` ã®ãƒšã‚¢ã€‚
 *
 * @internal
 */
const hands = [
	'ğŸ‘',
	'ğŸ‘',
	'ğŸ‘',
	'ğŸ‘Š',
	'âœŠ',
	['ğŸ¤›', 'ğŸ¤œ'],
	['ğŸ¤œ', 'ğŸ¤›'],
	'ğŸ¤',
	'âœŒ',
	'ğŸ¤Ÿ',
	'ğŸ¤˜',
	'ğŸ‘Œ',
	'ğŸ‘ˆ',
	'ğŸ‘‰',
	['ğŸ‘ˆ', 'ğŸ‘‰'],
	['ğŸ‘‰', 'ğŸ‘ˆ'],
	'ğŸ‘†',
	'ğŸ‘‡',
	'â˜',
	['âœ‹', 'ğŸ¤š'],
	'ğŸ–',
	'ğŸ––',
	'ğŸ‘‹',
	'ğŸ¤™',
	'ğŸ’ª',
	['ğŸ’ª', 'âœŒ'],
	//	'ğŸ–•'
];

/**
 * é¡”ã®çµµæ–‡å­—ãƒªã‚¹ãƒˆ
 *
 * @internal
 */
const faces = [
	'ğŸ˜€',
	'ğŸ˜ƒ',
	'ğŸ˜„',
	'ğŸ˜',
	'ğŸ˜†',
	'ğŸ˜…',
	'ğŸ˜‚',
	'ğŸ¤£',
	'â˜ºï¸',
	'ğŸ˜Š',
	'ğŸ˜‡',
	'ğŸ™‚',
	'ğŸ™ƒ',
	'ğŸ˜‰',
	'ğŸ˜Œ',
	'ğŸ˜',
	'ğŸ¥°',
	'ğŸ˜˜',
	'ğŸ˜—',
	'ğŸ˜™',
	'ğŸ˜š',
	'ğŸ˜‹',
	'ğŸ˜›',
	'ğŸ˜',
	'ğŸ˜œ',
	'ğŸ¤ª',
	'ğŸ¤¨',
	'ğŸ§',
	'ğŸ¤“',
	'ğŸ˜',
	'ğŸ¤©',
	'ğŸ¥³',
	'ğŸ˜',
	'ğŸ˜’',
	'ğŸ˜',
	'ğŸ˜”',
	'ğŸ˜Ÿ',
	'ğŸ˜•',
	'ğŸ™',
	'â˜¹ï¸',
	'ğŸ˜£',
	'ğŸ˜–',
	'ğŸ˜«',
	'ğŸ˜©',
	'ğŸ¥º',
	'ğŸ˜¢',
	'ğŸ˜­',
	'ğŸ˜¤',
	'ğŸ˜ ',
	'ğŸ˜¡',
	'ğŸ¤¬',
	'ğŸ¤¯',
	'ğŸ˜³',
	'ğŸ˜±',
	'ğŸ˜¨',
	'ğŸ˜°',
	'ğŸ˜¥',
	'ğŸ˜“',
	'ğŸ¤—',
	'ğŸ¤”',
	'ğŸ¤­',
	'ğŸ¤«',
	'ğŸ¤¥',
	'ğŸ˜¶',
	'ğŸ˜',
	'ğŸ˜‘',
	'ğŸ˜¬',
	'ğŸ™„',
	'ğŸ˜¯',
	'ğŸ˜¦',
	'ğŸ˜§',
	'ğŸ˜®',
	'ğŸ˜²',
	'ğŸ˜´',
	'ğŸ¤¤',
	'ğŸ˜ª',
	'ğŸ˜µ',
	'ğŸ¤',
	'ğŸ¥´',
	'ğŸ¤¢',
	'ğŸ¤®',
	'ğŸ¤§',
	'ğŸ˜·',
	'ğŸ¤’',
	'ğŸ¤•',
	'ğŸ¤‘',
	'ğŸ¤ ',
	'ğŸ—¿',
	'ğŸ¤–',
	'ğŸ‘½'
];

export default class extends Module {
	public readonly name = 'emoji';

	/**
	 * ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã€mentionHook ã‚’ç™»éŒ²ã™ã‚‹
	 *
	 * @returns mentionHook ã‚’å«ã‚€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«çµæœ
	 * @internal
	 */
	@autobind
	public install() {
		return {
			mentionHook: this.mentionHook
		};
	}

	/**
	 * ã€Œçµµæ–‡å­—ã€ç­‰ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«åå¿œã—ã€ãƒ©ãƒ³ãƒ€ãƒ ãªé¡”æ–‡å­—ã‚’ç”Ÿæˆã—ã¦è¿”ä¿¡ã™ã‚‹
	 *
	 * @param msg - å—ä¿¡ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
	 * @returns ãƒãƒƒãƒã—ãŸå ´åˆã¯ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³çµæœã€ã—ãªã‹ã£ãŸå ´åˆã¯ `false`
	 * @internal
	 */
	@autobind
	private async mentionHook(msg: Message) {
		if (msg.includes(['é¡”æ–‡å­—', 'çµµæ–‡å­—', 'emoji', 'ç¦ç¬‘ã„']) && !msg.includes(['æƒ…å ±'])) {
			const hand = hands[Math.floor(Math.random() * hands.length)];
			const face = faces[Math.floor(Math.random() * faces.length)];
			// ãƒšã‚¢ï¼ˆé…åˆ—ï¼‰ã®å ´åˆã¯å·¦å³ç•°ãªã‚‹çµµæ–‡å­—ã‚’ä½¿ã†
			const emoji = Array.isArray(hand) ? hand[0] + face + hand[1] : hand + face + hand;
			msg.reply(serifs.emoji.suggest(emoji), { visibility: 'public' });
			return {
				reaction: 'love'
			};
		} else {
			return false;
		}
	}
}
